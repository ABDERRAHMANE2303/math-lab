<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Math Lab</title>

    <!-- Link to our static CSS file -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="container">
    <h1>Math Lab </h1>

    <form id="calculator-form">
        <input type="number" id="a" placeholder="First number" required>

        <select id="operation">
            <option value="ADD">Add (+)</option>
            <option value="SUBTRACT">Subtract (-)</option>
            <option value="MULTIPLY">Multiply (ร)</option>
            <option value="DIVIDE">Divide (รท)</option>
            <option value="POWER">Power (^)</option>
            <option value="MODULO">Modulo (%)</option>
        </select>

        <input type="number" id="b" placeholder="Second number" required>

        <button type="submit">Calculate</button>
    </form>

    <div id="result">
        <!-- Result will be shown here -->
    </div>
</div>
<script>
const form = document.getElementById('calculator-form');
const resultDiv = document.getElementById('result');

form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const firstNumber = parseFloat(document.getElementById('a').value);
    const secondNumber = parseFloat(document.getElementById('b').value);
    const operation = document.getElementById('operation').value;

    const requestBody = { firstNumber, secondNumber, operation };

    try {
        const response = await fetch('/api/calculate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(requestBody)
        });

        const data = await response.json(); // parse JSON even if response.ok is false

        if (!response.ok) {
            // Show the error message from backend
            resultDiv.textContent = `Error: ${data.message || data.error}`;
            return;
        }

        resultDiv.textContent = `Result: ${data.result}`;
    } catch (err) {
        resultDiv.textContent = `Error: ${err.message}`;
    }
});
</script>
</body>
</html>
